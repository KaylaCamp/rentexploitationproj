?base::Logic
?base::logical
v20 %>%
filter(name %in% "B25118")
v20 %>%
filter(str_detect(name, "B25118"))
source("C:/Users/smang/OneDrive/Housing Justice DJA/rentexploitationproject/Data Cleaning/Data Cleaning.R", echo=TRUE)
#Ask dr. claibourne about tables
#importing data
library(readr)
library(tidycensus)
library(tidyverse)
library(tigris)
library(leaflet)
library(sf)
ACS_Housing_Data <- read_csv("Housing_Data.csv")
Income_By_Tenure <- read_csv("Income_By_Tenure.csv")
Tenure <- read_csv("Tenure.csv")
Tenure_By_Income <- read_csv("Tenure_By_Income.csv")
View(Tenure_By_Income)
v20 %>%
filter(str_detect(name, "B25118")) %>%
full_join(Tenure_By_Income, v20, by = c("variable" = "name"))
v20 %>%
filter(str_detect(name, "B25118")) %>%
full_join(Tenure_By_Income, v20, by = c("name" = "variable"))
v20 %>%
filter(str_detect(name, "B25118")) %>%
Tenure_By_Income <- full_join(Tenure_By_Income, v20, by = c("name" = "variable"))
v20 %>%
filter(str_detect(name, "B25118")) %>%
full_join(Tenure_By_Income, v20, by = c("name" = "variable"))
Tenure_By_Income <- v20 %>%
filter(str_detect(name, "B25118")) %>%
full_join(Tenure_By_Income, v20, by = c("name" = "variable")) %>%
select(1,2,5,6,7,8)
View(Tenure_By_Income)
unique(Tenure_By_Income$label)
Tenure_By_Income %>%
rename(Variable_Code = name) %>%
mutate(Variable = case_when(
str_detect(label, "Estimate!!Total:") ~ "Total",
str_detect(label, "Estimate!!Total:!!Owner occupied:") ~ "Owner Occupied",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!Less than $5,000") ~ "Owner occupied: <$5k",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$5,000 to $9,999") ~ "Owner occupied: $5k to $9,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$10,000 to $14,999") ~ "Owner occupied: $10k to $14,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$15,000 to $19,999") ~ "Owner occupied: $15k to $19,999",     str_detect(label, "Estimate!!Total:!!Owner occupied:!!$20,000 to $24,999") ~ "Owner occupied: $20k to $24,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$25,000 to $34,999") ~ "Owner occupied: $25k to $34,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$35,000 to $49,999") ~ "Owner occupied: $35k to $49,999",     str_detect(label, "Estimate!!Total:!!Owner occupied:!!$50,000 to $74,999") ~ "Owner occupied: $50k to $74,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$75,000 to $99,999") ~ "Owner occupied: $75k to $99,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$100,000 to $149,999") ~ "Owner occupied: $100k to  $149,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$150,000 or more") ~ "Owner occupied: $>150k",
str_detect(label, "Estimate!!Total:!!Renter occupied:") ~ "Renter Occupied",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!Less than $5,000") ~ "Renter occupied: <$5k",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$5,000 to $9,999") ~ "Renter occupied: $5k to $9,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$10,000 to $14,999") ~ "Renter occupied: $10k to $14,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$15,000 to $19,999") ~ "Renter occupied: $15k to $19,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$20,000 to $24,999") ~ "Renter occupied: $20k to $24,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$25,000 to $34,999") ~ "Renter occupied: $25k to $34,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$35,000 to $49,999") ~ "Renter occupied: $35k to $49,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$50,000 to $74,999") ~ "Renter occupied: $50k to $74,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$75,000 to $99,999") ~ "Renter occupied: $75k to $99,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$100,000 to $149,999") ~ "Renter occupied: $100k to  $149,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$150,000 or more") ~ "Renter occupied: $>150k"
))
Tenure_By_Income %>%
mutate(label = case_when(
str_detect(label, "Estimate!!Total:") ~ "Total",
str_detect(label, "Estimate!!Total:!!Owner occupied:") ~ "Owner Occupied",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!Less than $5,000") ~ "Owner occupied: <$5k",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$5,000 to $9,999") ~ "Owner occupied: $5k to $9,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$10,000 to $14,999") ~ "Owner occupied: $10k to $14,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$15,000 to $19,999") ~ "Owner occupied: $15k to $19,999",     str_detect(label, "Estimate!!Total:!!Owner occupied:!!$20,000 to $24,999") ~ "Owner occupied: $20k to $24,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$25,000 to $34,999") ~ "Owner occupied: $25k to $34,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$35,000 to $49,999") ~ "Owner occupied: $35k to $49,999",     str_detect(label, "Estimate!!Total:!!Owner occupied:!!$50,000 to $74,999") ~ "Owner occupied: $50k to $74,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$75,000 to $99,999") ~ "Owner occupied: $75k to $99,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$100,000 to $149,999") ~ "Owner occupied: $100k to  $149,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$150,000 or more") ~ "Owner occupied: $>150k",
str_detect(label, "Estimate!!Total:!!Renter occupied:") ~ "Renter Occupied",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!Less than $5,000") ~ "Renter occupied: <$5k",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$5,000 to $9,999") ~ "Renter occupied: $5k to $9,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$10,000 to $14,999") ~ "Renter occupied: $10k to $14,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$15,000 to $19,999") ~ "Renter occupied: $15k to $19,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$20,000 to $24,999") ~ "Renter occupied: $20k to $24,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$25,000 to $34,999") ~ "Renter occupied: $25k to $34,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$35,000 to $49,999") ~ "Renter occupied: $35k to $49,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$50,000 to $74,999") ~ "Renter occupied: $50k to $74,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$75,000 to $99,999") ~ "Renter occupied: $75k to $99,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$100,000 to $149,999") ~ "Renter occupied: $100k to  $149,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$150,000 or more") ~ "Renter occupied: $>150k"
)) %>%
rename(Variable_Code = name, Variable = label)
Tenure_By_Income <- Tenure_By_Income %>%
mutate(label = case_when(
str_detect(label, "Estimate!!Total:") ~ "Total",
str_detect(label, "Estimate!!Total:!!Owner occupied:") ~ "Owner Occupied",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!Less than $5,000") ~ "Owner occupied: <$5k",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$5,000 to $9,999") ~ "Owner occupied: $5k to $9,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$10,000 to $14,999") ~ "Owner occupied: $10k to $14,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$15,000 to $19,999") ~ "Owner occupied: $15k to $19,999",     str_detect(label, "Estimate!!Total:!!Owner occupied:!!$20,000 to $24,999") ~ "Owner occupied: $20k to $24,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$25,000 to $34,999") ~ "Owner occupied: $25k to $34,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$35,000 to $49,999") ~ "Owner occupied: $35k to $49,999",     str_detect(label, "Estimate!!Total:!!Owner occupied:!!$50,000 to $74,999") ~ "Owner occupied: $50k to $74,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$75,000 to $99,999") ~ "Owner occupied: $75k to $99,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$100,000 to $149,999") ~ "Owner occupied: $100k to  $149,999",
str_detect(label, "Estimate!!Total:!!Owner occupied:!!$150,000 or more") ~ "Owner occupied: $>150k",
str_detect(label, "Estimate!!Total:!!Renter occupied:") ~ "Renter Occupied",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!Less than $5,000") ~ "Renter occupied: <$5k",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$5,000 to $9,999") ~ "Renter occupied: $5k to $9,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$10,000 to $14,999") ~ "Renter occupied: $10k to $14,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$15,000 to $19,999") ~ "Renter occupied: $15k to $19,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$20,000 to $24,999") ~ "Renter occupied: $20k to $24,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$25,000 to $34,999") ~ "Renter occupied: $25k to $34,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$35,000 to $49,999") ~ "Renter occupied: $35k to $49,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$50,000 to $74,999") ~ "Renter occupied: $50k to $74,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$75,000 to $99,999") ~ "Renter occupied: $75k to $99,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$100,000 to $149,999") ~ "Renter occupied: $100k to  $149,999",
str_detect(label, "Estimate!!Total:!!Renter occupied:!!$150,000 or more") ~ "Renter occupied: $>150k"
)) %>%
rename(Variable_Code = name, Variable = label) %>%
mutate(County = case_when(
str_detect(GEOID, "51540") ~ "Charlottesville",
str_detect(GEOID, "51109") ~ "Louisa",
str_detect(GEOID, "51125") ~ "Nelson",
str_detect(GEOID, "51065") ~ "Fluvanna",
str_detect(GEOID, "51003") ~ "Albemarle",
str_detect(GEOID, "51079") ~ "Greene",
)) |>
select(3, 4, 7, 1, 2, 5, 6)
View(Tenure_By_Income)
ACS_Housing_Data %>%
ggplot(aes(x = PercRent0fIncomeE, y = RentTaxRatio, ymin=RentTaxRatio-RentTaxRatioMOE, ymax=RentTaxRatio+RentTaxRatioMOE)) +
geom_pointrange() +
facet_wrap(~County)
#importing data
library(readr)
library(tidycensus)
library(tidyverse)
library(tigris)
library(leaflet)
library(sf)
ACS_Housing_Data %>%
ggplot(aes(x = PercRent0fIncomeE, y = RentTaxRatio, ymin=RentTaxRatio-RentTaxRatioMOE, ymax=RentTaxRatio+RentTaxRatioMOE)) +
geom_pointrange() +
facet_wrap(~County)
#Ask dr. claibourne about tables
#importing data
library(readr)
library(tidycensus)
library(tidyverse)
library(tigris)
library(leaflet)
library(sf)
ACS_Housing_Data <- read_csv("Housing_Data.csv")
Income_By_Tenure <- read_csv("Income_By_Tenure.csv")
Tenure <- read_csv("Tenure.csv")
Tenure_By_Income <- read_csv("Tenure_By_Income.csv")
ACS_Housing_Data$MedianIncomeE <- Income_By_Tenure$B25119_003E
ACS_Housing_Data$MedianIncomeM <- Income_By_Tenure$B25119_003M
v20 <- load_variables(2020, "acs5", cache = TRUE)
Tenure_By_Income <- v20 %>%
filter(str_detect(name, "B25118")) %>%
full_join(Tenure_By_Income, v20, by = c("name" = "variable")) %>%
select(1,2,5,6,7,8)
Tenure_By_Income <- Tenure_By_Income %>%
mutate(County = case_when(
str_detect(GEOID, "51540") ~ "Charlottesville",
str_detect(GEOID, "51109") ~ "Louisa",
str_detect(GEOID, "51125") ~ "Nelson",
str_detect(GEOID, "51065") ~ "Fluvanna",
str_detect(GEOID, "51003") ~ "Albemarle",
str_detect(GEOID, "51079") ~ "Greene",
)) |>
select(3, 4, 7, 1, 2, 5, 6)
Tenure_By_Income %>%
filter(label %in% "Estimate!!Total:!!Renter occupied:!!$150,000 or more")
Tenure_By_Income %>%
mutate(label = case_when(
label %in% "Estimate!!Total:!!Renter occupied:!!$150,000 or more" ~ "Renter occupied: $>150k",
label %in% "Estimate!!Total:!!Renter occupied:!!$100,000 to $149,999") ~ "Renter occupied: $100k to  $149,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$75,000 to $99,999") ~ "Renter occupied: $75k to $99,999",
Tenure_By_Income %>%
Tenure_By_Income %>%
mutate(label = case_when(
label %in% "Estimate!!Total:!!Renter occupied:!!$150,000 or more" ~ "Renter occupied: $>150k",
label %in% "Estimate!!Total:!!Renter occupied:!!$100,000 to $149,999" ~ "Renter occupied: $100k to  $149,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$75,000 to $99,999" ~ "Renter occupied: $75k to $99,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$10,000 to $14,999" ~ "Owner occupied: $10k to $14,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$5,000 to $9,999" ~ "Owner occupied: $5k to $9,999",
label %in% "Estimate!!Total:!!Owner occupied:!!Less than $5,000" ~ "Owner occupied: <$5k",
label %in% "Estimate!!Total:!!Owner occupied:" ~ "Owner Occupied"
label %in% "Estimate!!Total:" ~ "Total"))
Tenure_By_Income %>%
mutate(label = case_when(
Tenure_By_Income$label %in% "Estimate!!Total:!!Renter occupied:!!$150,000 or more" ~ "Renter occupied: $>150k",
Tenure_By_Income$label %in% "Estimate!!Total:!!Renter occupied:!!$100,000 to $149,999" ~ "Renter occupied: $100k to  $149,999",
Tenure_By_Income$label %in% "Estimate!!Total:!!Renter occupied:!!$75,000 to $99,999" ~ "Renter occupied: $75k to $99,999",
Tenure_By_Income$label %in% "Estimate!!Total:!!Owner occupied:!!$10,000 to $14,999" ~ "Owner occupied: $10k to $14,999",
Tenure_By_Income$label %in% "Estimate!!Total:!!Owner occupied:!!$5,000 to $9,999" ~ "Owner occupied: $5k to $9,999",
Tenure_By_Income$label %in% "Estimate!!Total:!!Owner occupied:!!Less than $5,000" ~ "Owner occupied: <$5k",
Tenure_By_Income$label %in% "Estimate!!Total:!!Owner occupied:" ~ "Owner Occupied"
Tenure_By_Income$label %in% "Estimate!!Total:" ~ "Total"))
ACS_Housing_Data$MedianIncomeE <- Income_By_Tenure$B25119_003E
ACS_Housing_Data$MedianIncomeM <- Income_By_Tenure$B25119_003M
v20 <- load_variables(2020, "acs5", cache = TRUE)
Tenure_By_Income <- v20 %>%
filter(str_detect(name, "B25118")) %>%
full_join(Tenure_By_Income, v20, by = c("name" = "variable")) %>%
select(1,2,5,6,7,8)
Tenure_By_Income %>%
mutate(label = case_when(
Tenure_By_Income$label %in% "Estimate!!Total:!!Renter occupied:!!$150,000 or more" ~ "Renter occupied: $>150k",
Tenure_By_Income$label %in% "Estimate!!Total:!!Renter occupied:!!$100,000 to $149,999" ~ "Renter occupied: $100k to  $149,999",
Tenure_By_Income$label %in% "Estimate!!Total:!!Renter occupied:!!$75,000 to $99,999" ~ "Renter occupied: $75k to $99,999",
Tenure_By_Income$label %in% "Estimate!!Total:!!Owner occupied:!!$10,000 to $14,999" ~ "Owner occupied: $10k to $14,999",
Tenure_By_Income$label %in% "Estimate!!Total:!!Owner occupied:!!$5,000 to $9,999" ~ "Owner occupied: $5k to $9,999",
Tenure_By_Income$label %in% "Estimate!!Total:!!Owner occupied:!!Less than $5,000" ~ "Owner occupied: <$5k",
Tenure_By_Income$label %in% "Estimate!!Total:!!Owner occupied:" ~ "Owner Occupied"
Tenure_By_Income$label %in% "Estimate!!Total:" ~ "Total"))
Tenure_By_Income %>%
mutate(label = case_when(
Tenure_By_Income$label %in% "Estimate!!Total:!!Renter occupied:!!$150,000 or more" ~ "Renter occupied: $>150k",
Tenure_By_Income$label %in% "Estimate!!Total:!!Renter occupied:!!$100,000 to $149,999" ~ "Renter occupied: $100k to  $149,999",
Tenure_By_Income$label %in% "Estimate!!Total:!!Renter occupied:!!$75,000 to $99,999" ~ "Renter occupied: $75k to $99,999",
Tenure_By_Income$label %in% "Estimate!!Total:!!Owner occupied:!!$10,000 to $14,999" ~ "Owner occupied: $10k to $14,999",
Tenure_By_Income$label %in% "Estimate!!Total:!!Owner occupied:!!$5,000 to $9,999" ~ "Owner occupied: $5k to $9,999",
Tenure_By_Income$label %in% "Estimate!!Total:!!Owner occupied:!!Less than $5,000" ~ "Owner occupied: <$5k",
Tenure_By_Income$label %in% "Estimate!!Total:!!Owner occupied:" ~ "Owner Occupied"
Tenure_By_Income$label %in% "Estimate!!Total:" ~ "Total"))
Tenure_By_Income %>%
mutate(label = case_when(
label %in% "Estimate!!Total:!!Renter occupied:!!$150,000 or more" ~ "Renter occupied: $>150k",
label %in% "Estimate!!Total:!!Renter occupied:!!$100,000 to $149,999" ~ "Renter occupied: $100k to  $149,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$75,000 to $99,999" ~ "Renter occupied: $75k to $99,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$10,000 to $14,999" ~ "Owner occupied: $10k to $14,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$5,000 to $9,999" ~ "Owner occupied: $5k to $9,999",
label %in% "Estimate!!Total:!!Owner occupied:!!Less than $5,000" ~ "Owner occupied: <$5k",
label %in% "Estimate!!Total:!!Owner occupied:" ~ "Owner Occupied",
label %in% "Estimate!!Total:" ~ "Total"))
#Ask dr. claibourne about tables
#importing data
library(readr)
library(tidycensus)
library(tidyverse)
library(tigris)
library(leaflet)
library(sf)
ACS_Housing_Data <- read_csv("Housing_Data.csv")
Income_By_Tenure <- read_csv("Income_By_Tenure.csv")
Tenure <- read_csv("Tenure.csv")
Tenure_By_Income <- read_csv("Tenure_By_Income.csv")
#replacing all household income with the rent occupied household income since that's our focus
ACS_Housing_Data$MedianIncomeE <- Income_By_Tenure$B25119_003E
ACS_Housing_Data$MedianIncomeM <- Income_By_Tenure$B25119_003M
v20 <- load_variables(2020, "acs5", cache = TRUE)
Tenure_By_Income <- v20 %>%
filter(str_detect(name, "B25118")) %>%
full_join(Tenure_By_Income, v20, by = c("name" = "variable")) %>%
select(1,2,5,6,7,8)
Tenure_By_Income <- Tenure_By_Income %>%
mutate(County = case_when(
str_detect(GEOID, "51540") ~ "Charlottesville",
str_detect(GEOID, "51109") ~ "Louisa",
str_detect(GEOID, "51125") ~ "Nelson",
str_detect(GEOID, "51065") ~ "Fluvanna",
str_detect(GEOID, "51003") ~ "Albemarle",
str_detect(GEOID, "51079") ~ "Greene",
)) |>
select(3, 4, 7, 1, 2, 5, 6)
Tenure_By_Income %>%
group_by(label) %>%
summarize(n = n())
Tenure_By_Income %>%
mutate(label = case_when(
label %in% "Estimate!!Total:!!Renter occupied:!!$150,000 or more" ~ "Renter occupied: $>150k",
label %in% "Estimate!!Total:!!Renter occupied:!!$100,000 to $149,999" ~ "Renter occupied: $100k to  $149,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$75,000 to $99,999" ~ "Renter occupied: $75k to $99,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$50,000 to $74,999" ~ "Renter occupied: $50k to $74,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$35,000 to $49,999" ~ "Renter occupied: $35k to $49,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$25,000 to $34,999" ~ "Renter occupied: $25k to $34,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$20,000 to $24,999" ~ "Renter occupied: $20k to $24,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$15,000 to $19,999" ~ "Renter occupied: $15k to $19,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$10,000 to $14,999" ~ "Renter occupied: $10k to $14,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$5,000 to $9,999" ~ "Renter occupied: $5k to $9,999",
label %in% "Estimate!!Total:!!Renter occupied:!!Less than $5,000" ~ "Renter occupied: <$5k",
label %in% "Estimate!!Total:!!Renter occupied:" ~ "Renter Occupied",
label %in% "Estimate!!Total:!!Owner occupied:!!$150,000 or more" ~ "Owner occupied: $>150k",
label %in% "Estimate!!Total:!!Owner occupied:!!$100,000 to $149,999" ~ "Owner occupied: $100k to  $149,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$75,000 to $99,999" ~ "Owner occupied: $75k to $99,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$50,000 to $74,999" ~ "Owner occupied: $50k to $74,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$35,000 to $49,999" ~ "Owner occupied: $35k to $49,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$25,000 to $34,999" ~ "Owner occupied: $25k to $34,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$20,000 to $24,999" ~ "Owner occupied: $20k to $24,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$15,000 to $19,999" ~ "Owner occupied: $15k to $19,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$10,000 to $14,999" ~ "Owner occupied: $10k to $14,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$5,000 to $9,999" ~ "Owner occupied: $5k to $9,999",
label %in% "Estimate!!Total:!!Owner occupied:!!Less than $5,000" ~ "Owner occupied: <$5k",
label %in% "Estimate!!Total:!!Owner occupied:" ~ "Owner Occupied",
label %in% "Estimate!!Total:" ~ "Total"))  %>%
rename(Variable_Code = name, Variable = label)
View(Tenure_By_Income)
View(Tenure_By_Income)
View(Tenure_By_Income)
View(Tenure_By_Income)
View(Tenure_By_Income)
View(Tenure_By_Income)
Tenure_By_Income <- Tenure_By_Income %>%
mutate(label = case_when(
label %in% "Estimate!!Total:!!Renter occupied:!!$150,000 or more" ~ "Renter occupied: $>150k",
label %in% "Estimate!!Total:!!Renter occupied:!!$100,000 to $149,999" ~ "Renter occupied: $100k to  $149,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$75,000 to $99,999" ~ "Renter occupied: $75k to $99,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$50,000 to $74,999" ~ "Renter occupied: $50k to $74,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$35,000 to $49,999" ~ "Renter occupied: $35k to $49,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$25,000 to $34,999" ~ "Renter occupied: $25k to $34,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$20,000 to $24,999" ~ "Renter occupied: $20k to $24,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$15,000 to $19,999" ~ "Renter occupied: $15k to $19,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$10,000 to $14,999" ~ "Renter occupied: $10k to $14,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$5,000 to $9,999" ~ "Renter occupied: $5k to $9,999",
label %in% "Estimate!!Total:!!Renter occupied:!!Less than $5,000" ~ "Renter occupied: <$5k",
label %in% "Estimate!!Total:!!Renter occupied:" ~ "Renter Occupied",
label %in% "Estimate!!Total:!!Owner occupied:!!$150,000 or more" ~ "Owner occupied: $>150k",
label %in% "Estimate!!Total:!!Owner occupied:!!$100,000 to $149,999" ~ "Owner occupied: $100k to  $149,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$75,000 to $99,999" ~ "Owner occupied: $75k to $99,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$50,000 to $74,999" ~ "Owner occupied: $50k to $74,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$35,000 to $49,999" ~ "Owner occupied: $35k to $49,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$25,000 to $34,999" ~ "Owner occupied: $25k to $34,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$20,000 to $24,999" ~ "Owner occupied: $20k to $24,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$15,000 to $19,999" ~ "Owner occupied: $15k to $19,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$10,000 to $14,999" ~ "Owner occupied: $10k to $14,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$5,000 to $9,999" ~ "Owner occupied: $5k to $9,999",
label %in% "Estimate!!Total:!!Owner occupied:!!Less than $5,000" ~ "Owner occupied: <$5k",
label %in% "Estimate!!Total:!!Owner occupied:" ~ "Owner Occupied",
label %in% "Estimate!!Total:" ~ "Total"))  %>%
rename(Variable_Code = name, Variable = label)
View(Tenure_By_Income)
?colorNumeric
#making GEOID numeric so I can join it with ACSHousingData
countytracts <- countytracts |>
mutate(GEOID = as.numeric(countytracts$GEOID))
#creating a leaflet map!
#install.packages("tigris")
# library(tigris)
#creating a vector of the counties i need
counties <- c("Albemarle", "Charlottesville", "Fluvanna", "Greene", "Louisa", "Nelson")
#creates a dataframe of the tracts and geographic info in our dataset, can put names or the code numbers for the county argument
countytracts <- tracts(state = "VA", county = counties, year = 2020)
#making GEOID numeric so I can join it with ACSHousingData
countytracts <- countytracts |>
mutate(GEOID = as.numeric(countytracts$GEOID))
HousingDataSpatial <- full_join(ACS_Housing_Data, countytracts, by = "GEOID") |>
sf::st_as_sf() |>
mutate(INTPTLAT = as.numeric(str_remove(countytracts$INTPTLAT, "[^[:alnum:]]")), INTPTLON = as.numeric(str_remove(countytracts$INTPTLON, "[^[:alnum:]]")))  |>
sf::st_transform(crs = '+proj=longlat +datum=WGS84')
# create color palette for shading census tracts
pal <-  colorNumeric("YlOrRd", HousingDataSpatial$RentTaxRatio)
View(HousingDataSpatial)
pal1 <- colorNumeric("Greens", HousingDataSpatial$County)
pal1 <- colorNumeric("Greens", domain = HousingDataSpatial$County, HousingDataSpatial$County)
#creating map and adding layers
leaflet(HousingDataSpatial) %>%
addTiles() %>%
addPolygons() %>%
addLabelOnlyMarkers(lng = ~INTPTLON, lat = ~INTPTLAT, label = ~NAME.y,
labelOptions = labelOptions(noHide = TRUE)) %>% #labels census tracts
addPolygons(stroke = FALSE, fillOpacity = 0.5,
smoothFactor = 0.5,
color = ~pal(RentTaxRatio),
label = ~RentTaxRatio) %>%
addLegend(pal = pal,
values = ~RentTaxRatio,
opacity = 0.9,
title = "Estimated Rent to Tax Ratio for 2020",
position = "bottomleft")
HousingDataSpatial <- full_join(ACS_Housing_Data, countytracts, by = "GEOID") |>
sf::st_as_sf() |>
mutate(INTPTLAT = as.numeric(countytracts$INTPTLAT), INTPTLON = as.numeric(countytracts$INTPTLON))|>
sf::st_transform(crs = '+proj=longlat +datum=WGS84')
View(HousingDataSpatial)
# create color palette for shading census tracts
pal <-  colorNumeric("YlOrRd", HousingDataSpatial$RentTaxRatio)
#creating map and adding layers
leaflet(HousingDataSpatial) %>%
addTiles() %>%
addPolygons() %>%
#addLabelOnlyMarkers(lng = ~INTPTLON, lat = ~INTPTLAT, label = ~NAME.y,
#                   labelOptions = labelOptions(noHide = TRUE)) %>% #labels census tracts
addPolygons(stroke = FALSE, fillOpacity = 0.5,
smoothFactor = 0.5,
color = ~pal(RentTaxRatio),
label = ~RentTaxRatio) %>%
addLegend(pal = pal,
values = ~RentTaxRatio,
opacity = 0.9,
title = "Estimated Rent to Tax Ratio for 2020",
position = "bottomleft")
#creating map and adding layers
leaflet(HousingDataSpatial) %>%
addTiles() %>%
addPolygons() %>%
addLabelOnlyMarkers(lng = ~INTPTLON, lat = ~INTPTLAT, label = ~NAME.y,
labelOptions = labelOptions(noHide = TRUE)) %>% #labels census tracts
addPolygons(stroke = FALSE, fillOpacity = 0.5,
smoothFactor = 0.5,
color = ~pal(RentTaxRatio),
label = ~RentTaxRatio) %>%
addLegend(pal = pal,
values = ~RentTaxRatio,
opacity = 0.9,
title = "Estimated Rent to Tax Ratio for 2020",
position = "bottomleft")
?addLave
?addLabelOnlyMarkers
#creating map and adding layers
leaflet(HousingDataSpatial) %>%
addTiles() %>%
addPolygons() %>%
addLabelOnlyMarkers(lng = ~INTPTLON, lat = ~INTPTLAT, label = ~County,
labelOptions = labelOptions(noHide = TRUE)) %>% #labels census tracts
addPolygons(stroke = FALSE, fillOpacity = 0.5,
smoothFactor = 0.5,
color = ~pal(RentTaxRatio),
label = ~RentTaxRatio) %>%
addLegend(pal = pal,
values = ~RentTaxRatio,
opacity = 0.9,
title = "Estimated Rent to Tax Ratio for 2020",
position = "bottomleft")
Tenure_By_Income %>%
ggplot(aes(Tenure_By_Income$estimate)) +
geom_histogram() +
facet_wrap(~County)
#Ask dr. claibourne about tables
#importing data
library(readr)
library(tidycensus)
library(tidyverse)
library(tigris)
library(leaflet)
library(sf)
ACS_Housing_Data <- read_csv("Housing_Data.csv")
Income_By_Tenure <- read_csv("Income_By_Tenure.csv")
Tenure <- read_csv("Tenure.csv")
Tenure_By_Income <- read_csv("Tenure_By_Income.csv")
Tenure_By_Income %>%
ggplot(aes(Tenure_By_Income$estimate)) +
geom_histogram() +
facet_wrap(~County)
Tenure_By_Income %>%
ggplot(aes(Tenure_By_Income$estimate)) +
geom_histogram()
Tenure_By_Income %>%
ggplot(aes(Tenure_By_Income$estimate)) +
geom_histogram() +
facet_wrap(~County)
#replacing all household income with the rent occupied household income since that's our focus
ACS_Housing_Data$MedianIncomeE <- Income_By_Tenure$B25119_003E
ACS_Housing_Data$MedianIncomeM <- Income_By_Tenure$B25119_003M
v20 <- load_variables(2020, "acs5", cache = TRUE)
Tenure_By_Income <- v20 %>%
filter(str_detect(name, "B25118")) %>%
full_join(Tenure_By_Income, v20, by = c("name" = "variable")) %>%
select(1,2,5,6,7,8)
Tenure_By_Income <- Tenure_By_Income %>%
mutate(County = case_when(
str_detect(GEOID, "51540") ~ "Charlottesville",
str_detect(GEOID, "51109") ~ "Louisa",
str_detect(GEOID, "51125") ~ "Nelson",
str_detect(GEOID, "51065") ~ "Fluvanna",
str_detect(GEOID, "51003") ~ "Albemarle",
str_detect(GEOID, "51079") ~ "Greene",
)) |>
select(3, 4, 7, 1, 2, 5, 6)
#Tenure_By_Income %>%
# group_by(label) %>%
#summarize(n = n())
#unique(Tenure_By_Income$label), used this line for the code below, wanted to change the variable name the census gave me
Tenure_By_Income <- Tenure_By_Income %>%
mutate(label = case_when(
label %in% "Estimate!!Total:!!Renter occupied:!!$150,000 or more" ~ "Renter occupied: $>150k",
label %in% "Estimate!!Total:!!Renter occupied:!!$100,000 to $149,999" ~ "Renter occupied: $100k to  $149,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$75,000 to $99,999" ~ "Renter occupied: $75k to $99,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$50,000 to $74,999" ~ "Renter occupied: $50k to $74,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$35,000 to $49,999" ~ "Renter occupied: $35k to $49,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$25,000 to $34,999" ~ "Renter occupied: $25k to $34,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$20,000 to $24,999" ~ "Renter occupied: $20k to $24,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$15,000 to $19,999" ~ "Renter occupied: $15k to $19,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$10,000 to $14,999" ~ "Renter occupied: $10k to $14,999",
label %in% "Estimate!!Total:!!Renter occupied:!!$5,000 to $9,999" ~ "Renter occupied: $5k to $9,999",
label %in% "Estimate!!Total:!!Renter occupied:!!Less than $5,000" ~ "Renter occupied: <$5k",
label %in% "Estimate!!Total:!!Renter occupied:" ~ "Renter Occupied",
label %in% "Estimate!!Total:!!Owner occupied:!!$150,000 or more" ~ "Owner occupied: $>150k",
label %in% "Estimate!!Total:!!Owner occupied:!!$100,000 to $149,999" ~ "Owner occupied: $100k to  $149,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$75,000 to $99,999" ~ "Owner occupied: $75k to $99,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$50,000 to $74,999" ~ "Owner occupied: $50k to $74,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$35,000 to $49,999" ~ "Owner occupied: $35k to $49,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$25,000 to $34,999" ~ "Owner occupied: $25k to $34,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$20,000 to $24,999" ~ "Owner occupied: $20k to $24,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$15,000 to $19,999" ~ "Owner occupied: $15k to $19,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$10,000 to $14,999" ~ "Owner occupied: $10k to $14,999",
label %in% "Estimate!!Total:!!Owner occupied:!!$5,000 to $9,999" ~ "Owner occupied: $5k to $9,999",
label %in% "Estimate!!Total:!!Owner occupied:!!Less than $5,000" ~ "Owner occupied: <$5k",
label %in% "Estimate!!Total:!!Owner occupied:" ~ "Owner Occupied",
label %in% "Estimate!!Total:" ~ "Total"))  %>%
rename(Variable_Code = name, Variable = label)
Tenure_By_Income %>%
ggplot(aes(Tenure_By_Income$estimate)) +
geom_histogram() +
facet_wrap(~County)
Tenure_By_Income %>%
ggplot(aes(Tenure_By_Income$estimate, fill = County)) +
geom_histogram()
View(Tenure_By_Income)
View(Tenure)
