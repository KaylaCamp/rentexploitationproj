# Explore rent to tax ratio measure
# and some mapping

library(tidyverse)
library(tigris)
library(sf)

# Start Exploration ----
# overall
summary(cvl_rent2$rent_tax_ratio)

# by locality
cvl_rent2 %>% 
  group_by(county) %>% 
  summarize(tracts = n(),
            mean = mean(rent_tax_ratio, na.rm = TRUE),
            sd = sd(rent_tax_ratio, na.rm = TRUE),
            med = median(rent_tax_ratio, na.rm = TRUE))

ggplot(cvl_rent2, aes(x = rent_tax_ratio)) +
  geom_histogram(binwidth = .05)
# what's the outlier? Albemarle 113.02

# more viz and summarization, including of componenets (rent, tax)

# Mapping ----
# get tract shapefiles
cvl_tracts <- tracts(state = "51", county = cvl, year = 2020)

cvl_rents <- cvl_tracts %>% 
  left_join(cvl_rent2, by = "GEOID")

ggplot(cvl_rents) +
  geom_sf(aes(fill = county)) +
  theme_void()
