---
title: "Rent Exploitation Final Markdown"
author: "Kayla Campbell"
date: '2022-07-06'
output: html_document
---
Intro on the history of Charlottesville...
         the housing market...
         renter explotation...
#map census tracs rave v. median income         
##Loading packages for exploration
```{r}
library(readr)
library(leaflet)
library(ggplot2)
library(dplyr)
library(scales)
library(tidyverse)
library(tigris)
library(sf)
library(viridis)
library(RColorBrewer)
```


```{r}
# Reading in exported data to R markdown
library(readr)
ACSData2020 <- read_csv("ACSData2020.csv")
ACSData2020
```
Let us find the median values per region.
```{r}
ACSData2020 %>% 
  group_by(Region) %>% 
  summarize(med_renterhh_e= median(MedRenterHHIncomeE,na.rm=TRUE), med_renterhh_m= median(MedRenterHHIncomeM, na.rm=TRUE), med_rent_est= median(MedRentE, na.rm=TRUE), med_rent_moe= median(MedRentM, na.rm=TRUE), med_tax_est=median(MedTaxE), med_tax_moe= median(MedRentM, na.rm=TRUE), MedRentTaxRatE=median(RentTaxRatE, na.rm=TRUE), MedRentTaxRatMOE=median(RentTaxRatMOE, na.rm=TRUE),  MedRenterHHIncomem=median(MedRenterHHIncomeM, na.rm=TRUE), MedRentPercHHIncomee=median(MedRentPercHHIncomeE, na.rm=TRUE), MedRenterPErcHHIncomem=median(MedRentPercHHIncomeM, na.rm=TRUE))
```
... and further by county.
```{r}
CensusHousingData %>% 
  group_by(County) %>% 
  summarize(med_rent_est= median(MedRentE, na.rm=TRUE), med_rent_moe= median(MedRentM, na.rm=TRUE), med_tax_est=median(MedTaxE), med_tax_moe= median(MedRentM, na.rm=TRUE), MedRentTaxRatE=median(RentTaxRatE, na.rm=TRUE), MedRentTaxRatMOE=median(RentTaxRatMOE, na.rm=TRUE), MedRenterHHIncomee =median(MedRenterHHIncomeE, na.rm=TRUE), MedRenterHHIncomem=median(MedRenterHHIncomeM, na.rm=TRUE), MedRentPercHHIncomee=median(MedRentPercHHIncomeE, na.rm=TRUE), MedRenterPErcHHIncomem=median(MedRentPercHHIncomeM, na.rm=TRUE))
```


As defined by Crowell, rent exploitation is the ratio of median rents to median property taxes (Crowell 2). We will examine how rent exploitation varies by counties in the Charlottesville and Richmond regions.
```{r}
countytracts <- tracts(state = "51", county = cvl, year = 2020)
ACSData2020 <- countytracts %>% 
  mutate(GEOID = as.numeric(countytracts$GEOID))
  st_join(ACSData2020, countytracts, by = c("GEOID"))

by = "GEOID"
countytracts <- tracts(state = "51", county = cvl, year = 2020)
countytracts<-countytracts %>% 
  mutate(GEOID = as.numeric(countytracts$GEOID))
# by = c("GEOID1" = "GEOID2")
PovertybyRace <- st_transform(PovertybyRace, 4326)

pal <- colorNumeric("viridis", reverse = TRUE, domain = PovertybyRace$IncomeInequalityE) # viridis
leaflet(PovertybyRace) %>% 
  #addTiles() %>% # basemap
  addProviderTiles("CartoDB.Positron") %>% # CartoDB.Positron, Stamen.Toner, Esri.NatGeoWorldMap
  addPolygons(fillColor = ~pal(IncomeInequalityE),
              fillOpacity = 0.8,
              color = "white",
              weight = 2,
              highlight = highlightOptions(
                weight = 3,
                fillOpacity = 0.9,
                bringToFront = T),
              popup = paste0("County: ", PovertybyRace$County, "<br>",
                             "Tract: ", PovertybyRace$NAMELSAD, "<br>",
                             "Gini Index: ", round(PovertybyRace$IncomeInequalityE, 2)))%>% 
  addLegend("topright", pal = pal, values = PovertybyRace$IncomeInequalityE, 
          title = "Gini Index of Income Inequality", opacity = 0.7)
```

How does the median renters household income relate to the median rent they are paying as proof of rent burden?
```{r}
ggplot(ACSData2020) +
  aes(x = MedRenterHHIncomeE, y = MedRentE) +
  geom_point() 
```
Which census tracts face the highest le

As expected the lower the household income the less the renter can afford to pay. However does how much they are paying 
```{r}
Tenure <- read_csv("TenureData.csv")
Tenure
```
```{r}
TenureByRace <- read_csv("TenureByRaceData.csv")
TenureByRace
```
##Note the lack of representation of housholds in particular census tracts
```{r}
PovertybyRace <- read_csv("PovertybyRaceData.csv")
PovertybyRace
```

A representation of the income inequality occuring in and around Charlottesville and Richmond Virginia based on the Gini Index's ruling.
```{r}
countytracts <- tracts(state = "51", county = cvl, year = 2020)
countytracts<-countytracts %>% 
  mutate(GEOID = as.numeric(countytracts$GEOID))
# by = c("GEOID1" = "GEOID2")
PovertybyRace <- st_transform(PovertybyRace, 4326)

pal <- colorNumeric("viridis", reverse = TRUE, domain = PovertybyRace$IncomeInequalityE) # viridis
leaflet(PovertybyRace) %>% 
  #addTiles() %>% # basemap
  addProviderTiles("CartoDB.Positron") %>% # CartoDB.Positron, Stamen.Toner, Esri.NatGeoWorldMap
  addPolygons(fillColor = ~pal(IncomeInequalityE),
              fillOpacity = 0.8,
              color = "white",
              weight = 2,
              highlight = highlightOptions(
                weight = 3,
                fillOpacity = 0.9,
                bringToFront = T),
              popup = paste0("County: ", PovertybyRace$County, "<br>",
                             "Tract: ", PovertybyRace$NAMELSAD, "<br>",
                             "Gini Index: ", round(PovertybyRace$IncomeInequalityE, 2)))%>% 
  addLegend("topright", pal = pal, values = PovertybyRace$IncomeInequalityE, 
          title = "Gini Index of Income Inequality", opacity = 0.7)
```
Does Charlottesville have a Black middle class?
Demographic map
